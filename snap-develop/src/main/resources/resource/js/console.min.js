var ProcessConsole;
(function(e){function n(b,a){var c=document.getElementById("console");null!=c&&(c.style.fontFamily=b,c.style.fontSize=a);l=b;m=a}function p(b,a,c){h==c&&k();b=g[c];null!=b&&(b.valid=!1)}function q(){null!=document.getElementById("console")&&(document.getElementById("console").innerHTML="");h=null}function k(){var b=document.getElementById("console"),a=null,c=null;if(null!=b&&null!=h){var d=b.innerHTML,e=g[h];if(null!=e&&(""==d||1==e.update)){e.update=!1;for(d=0;d<e.list.length;d++){var f=e.list[d];
null==c?(a=f.error?"\x3cspan class\x3d'consoleError'\x3e"+f.text:"\x3cspan class\x3d'consoleNormal'\x3e"+f.text,c=f.error):f.error!=c?(a+="\x3c/span\x3e",a=f.error?a+("\x3cspan class\x3d'consoleError'\x3e"+f.text):a+("\x3cspan class\x3d'consoleNormal'\x3e"+f.text),c=f.error):a+=f.text}null!=a&&(b.innerHTML=a+"\x3c/span\x3e",b.scrollTop=b.scrollHeight)}l&&m&&n(l,m)}}function r(b){if(h!=b){var a={},c;for(c in g)if(g.hasOwnProperty(c)){var d=g[c];if(d.valid||c==b)a[c]=d}g=a;q();h=b;k()}}function v(b,
a,c){b=JSON.parse(c).process;g[b]={list:[],size:0,update:!0,valid:!0};r(b)}function t(b,a,c){var d=c.indexOf(":");b=c.substring(0,d);c=c.substring(d+1);d={error:"PRINT_ERROR"==a,text:c};a=g[b];null==a&&(a={list:[],size:0,update:!0,valid:!0},g[b]=a);a.list.push(d);for(a.size+=c.length;3<a.list.length&&a.size>u;)b=a.list.shift(),null!=b&&(a.size-=b.text.length);a.update=!0}var g={},u=5E3,h=null,l=null,m=null;e.registerConsole=function(){EventBus.createRoute("BEGIN",v,null);EventBus.createRoute("PRINT_ERROR",
t,null);EventBus.createRoute("PRINT_OUTPUT",t,null);EventBus.createRoute("TERMINATE",p,null);EventBus.createRoute("EXIT",p,null);setInterval(k,200)};e.updateConsoleFont=n;e.updateConsoleCapacity=function(b){u=b};e.clearConsole=q;e.showConsole=k;e.updateConsoleFocus=r})(ProcessConsole||(ProcessConsole={}));ModuleSystem.registerModule("console","Console module: console.js",null,ProcessConsole.registerConsole,["common","socket"]);
