var Command;
(function(b){function p(a,d){a?jQuery.ajax({url:"/type/"+document.title+"?expression\x3d"+a,success:function(a){var c=[],e;for(e in a)a.hasOwnProperty(e)&&c.push(e);c.sort();for(var b=[],g=0;g<c.length;g++)e=c[g],e=a[e],b.push({name:e.name,resource:e.resource,type:e.type,project:document.title});d(b)},async:!0}):d([])}function l(a,d){d||(d="*.snap,*.properties,*.xml,*.txt,*.json");var c=DialogBuilder.createTextSearchOnlyDialog;a&&(c=DialogBuilder.createTextSearchAndReplaceDialog);c(function(a,d,c,
b){m(a,d,c,function(a){for(var d=[],c=0;c<a.length;c++){var e=a[c],f=window.document.location.pathname;f.indexOf(";debug",f.length-6);f="/resource/"+e.project+"/"+e.resource;d.push([{text:e.resource,line:e.line,resource:f,style:"resourceNode"},{text:e.text,line:e.line,resource:f,style:"textNode"}])}return b(d)})},d,a?"Replace Text":"Find Text")}function m(a,d,c,b){if(a&&1<a.length){var e;e="/find/"+document.title;e+="?expression\x3d"+encodeURIComponent(a);e+="\x26pattern\x3d"+encodeURIComponent(d);
e+="\x26caseSensitive\x3d"+encodeURIComponent(c.caseSensitive);e+="\x26regularExpression\x3d"+encodeURIComponent(c.regularExpression);e+="\x26wholeWord\x3d"+encodeURIComponent(c.wholeWord);e+="\x26replace\x3d"+encodeURIComponent(c.replace);e+="\x26enableReplace\x3d"+encodeURIComponent(c.enableReplace);jQuery.ajax({url:e,success:function(a){for(var d=[],c=0;c<a.length;c++)d.push(a[c]);b(d)},async:!0})}else b([])}function q(a,d){a&&1<a.length?jQuery.ajax({url:"/file/"+document.title+"?expression\x3d"+
a,success:function(a){for(var c=[],b=0;b<a.length;b++)c.push(a[b]);d(c)},async:!0}):d([])}function n(a,d){var c=FileEditor.loadEditor();null==c.resource?DialogBuilder.openTreeDialog(null,!1,function(c){h(d);a()}):FileEditor.isEditorChanged()?DialogBuilder.openTreeDialog(c.resource,!0,function(c){h(d);a()}):(ProcessConsole.clearConsole(),a())}function h(a){var d=FileEditor.loadEditor(),c=d.resource;if(null!=c){var b={project:document.title,resource:c.filePath,source:d.source,directory:!1,create:!1};
ProcessConsole.clearConsole();EventBus.sendEvent("SAVE",b);a&&FileEditor.updateEditor(d.source,c.projectPath)}}b.searchTypes=function(){DialogBuilder.createListDialog(function(a,d,c){p(a,function(a){for(var d=[],b=0;b<a.length;b++){var g=window.document.location.pathname,g=-1!==g.indexOf(";debug",g.length-6),f="/project/"+a[b].project;g&&(f+=";debug");f+="#"+a[b].resource;d.push([{text:a[b].name,link:f,style:"module"==a[b].type?"moduleNode":"typeNode"},{text:a[b].resource,link:f,style:"resourceNode"}])}c(d)})},
null,"Search Types")};b.replaceTokenInFiles=function(a,d,b){m(a,b,d,function(a){for(var d=FileEditor.loadEditor(),b=0;b<a.length;b++){var c=a[b],c=FileTree.createResourcePath("/resource/"+c.project+"/"+c.resource);d.resource.resourcePath==c.resourcePath&&FileExplorer.openTreeFile(c.resourcePath,function(){})}})};b.searchFiles=function(a){l(!1,a)};b.searchAndReplaceFiles=function(a){l(!0,a)};b.findFileNames=function(){DialogBuilder.createListDialog(function(a,d,b){q(a,function(a){for(var d=[],c=0;c<
a.length;c++){var f=a[c],k=window.document.location.pathname,k=-1!==k.indexOf(";debug",k.length-6),h="/project/"+f.project;k&&(h+=";debug");h+="#"+f.resource;d.push([{text:f.text,link:h,style:"resourceNode"}])}return b(d)})},null,"Find Files")};b.exploreDirectory=function(a){FileTree.isResourceFolder(a.filePath)&&EventBus.sendEvent("EXPLORE",{project:document.title,resource:a.filePath})};b.folderExpand=function(a){EventBus.sendEvent("FOLDER_EXPAND",{project:document.title,folder:a})};b.folderCollapse=
function(a){EventBus.sendEvent("FOLDER_COLLAPSE",{project:document.title,folder:a})};b.pingProcess=function(){EventBus.isSocketOpen()&&EventBus.sendEvent("PING",document.title)};b.renameFile=function(a){var d=a.filePath;DialogBuilder.renameFileTreeDialog(a,!0,function(b){EventBus.sendEvent("RENAME",{project:document.title,from:d,to:b.filePath});Project.renameEditorTab(a.resourcePath,b.resourcePath)})};b.renameDirectory=function(a){var d=a.filePath;a=FileTree.createResourcePath(d+".#");DialogBuilder.renameDirectoryTreeDialog(a,
!0,function(a){EventBus.sendEvent("RENAME",{project:document.title,from:d,to:a.filePath})})};b.newFile=function(a){DialogBuilder.newFileTreeDialog(a,!0,function(a){if(!FileTree.isResourceFolder(a.filePath)){var b={project:document.title,resource:a.filePath,source:"",directory:!1,create:!0};ProcessConsole.clearConsole();EventBus.sendEvent("SAVE",b);FileEditor.updateEditor("",a.projectPath)}})};b.newDirectory=function(a){DialogBuilder.newDirectoryTreeDialog(a,!0,function(a){FileTree.isResourceFolder(a.filePath)&&
(a={project:document.title,resource:a.filePath,source:"",directory:!0,create:!0},ProcessConsole.clearConsole(),EventBus.sendEvent("SAVE",a))})};b.saveFile=function(){n(function(){},!0)};b.saveEditor=h;b.deleteFile=function(a){var b=FileEditor.loadEditor();null==a&&null!=b.resource&&(a=b.resource);null!=a&&(b=FileEditor.loadEditor(),Alerts.createConfirmAlert("Delete File","Delete resource "+b.resource.filePath,"Delete","Cancel",function(){var d={project:document.title,resource:a.filePath};ProcessConsole.clearConsole();
EventBus.sendEvent("DELETE",d);null!=b.resource&&b.resource.resourcePath==a.resourcePath&&FileEditor.resetEditor();Project.deleteEditorTab(a.resourcePath)},function(){}))};b.deleteDirectory=function(a){null!=a&&(a={project:document.title,resource:a.filePath},ProcessConsole.clearConsole(),EventBus.sendEvent("DELETE",a))};b.runScript=function(){n(function(){var a=FileEditor.loadEditor();EventBus.sendEvent("EXECUTE",{breakpoints:a.breakpoints,project:document.title,resource:a.resource.filePath,source:a.source})},
!0)};b.updateScriptBreakpoints=function(){var a={breakpoints:FileEditor.loadEditor().breakpoints,project:document.title};EventBus.sendEvent("BREAKPOINTS",a)};b.stepOverScript=function(){var a=ThreadManager.focusedThread();null!=a&&(a={thread:a.thread,type:"STEP_OVER"},FileEditor.clearEditorHighlights(),EventBus.sendEvent("STEP",a))};b.stepInScript=function(){var a=ThreadManager.focusedThread();null!=a&&(a={thread:a.thread,type:"STEP_IN"},FileEditor.clearEditorHighlights(),EventBus.sendEvent("STEP",
a))};b.stepOutScript=function(){var a=ThreadManager.focusedThread();null!=a&&(a={thread:a.thread,type:"STEP_OUT"},FileEditor.clearEditorHighlights(),EventBus.sendEvent("STEP",a))};b.resumeScript=function(){var a=ThreadManager.focusedThread();null!=a&&(a={thread:a.thread,type:"RUN"},FileEditor.clearEditorHighlights(),EventBus.sendEvent("STEP",a))};b.stopScript=function(){EventBus.sendEvent("STOP")};b.browseScriptVariables=function(a){var b=ThreadManager.focusedThread();null!=b&&EventBus.sendEvent("BROWSE",
{thread:b.thread,expand:a})};b.browseScriptEvaluation=function(a,b,c){var d=ThreadManager.focusedThread();null!=d&&EventBus.sendEvent("EVALUATE",{thread:d.thread,expression:b,expand:a,refresh:c})};b.attachProcess=function(a){var b=DebugManager.currentStatusFocus(),c=FileEditor.loadEditor();EventBus.sendEvent("ATTACH",{process:a,breakpoints:c.breakpoints,project:document.title,focus:b!=a})};b.switchLayout=function(){var a=window.document.location.pathname,b=window.document.location.hash;-1!==a.indexOf(";debug",
a.length-6)?(a=a.substring(0,a.length-6),document.location=a+b):document.location=a+";debug"+b};b.updateDisplay=function(a){EventBus.isSocketOpen()&&EventBus.sendEvent("DISPLAY_UPDATE",a)};b.evaluateExpression=function(){if(null!=ThreadManager.focusedThread()){var a=FileEditor.getSelectedText();DialogBuilder.evaluateExpressionDialog(a)}};b.refreshScreen=function(){setTimeout(function(){location.reload()},10)};b.switchProject=function(){document.location="/"}})(Command||(Command={}));
ModuleSystem.registerModule("commands","Commands module: commands.js",null,null,["common","editor","tree","threads"]);
