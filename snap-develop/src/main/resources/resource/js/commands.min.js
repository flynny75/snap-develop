var Command;
(function(b){function l(a){var c=[];jQuery.ajax({url:"/type/"+document.title+"?expression\x3d"+a,success:function(a){var d=[],e;for(e in a)a.hasOwnProperty(e)&&d.push(e);d.sort();for(var b=0;b<d.length;b++)e=d[b],e=a[e],c.push({name:e.name,resource:e.resource,type:e.type,project:document.title})},async:!1});return c}function m(a,c){var d=[];a&&1<a.length&&jQuery.ajax({url:"/find/"+document.title+"?expression\x3d"+a+"\x26pattern\x3d"+c,success:function(a){for(var c=0;c<a.length;c++)d.push(a[c])},async:!1});
return d}function n(a){var c=[];a&&1<a.length&&jQuery.ajax({url:"/file/"+document.title+"?expression\x3d"+a,success:function(a){for(var d=0;d<a.length;d++)c.push(a[d])},async:!1});return c}function k(a,c){var d=FileEditor.loadEditor();null==d.resource?DialogBuilder.openTreeDialog(null,!1,function(d){h(c);a()}):FileEditor.isEditorChanged()?DialogBuilder.openTreeDialog(d.resource,!0,function(d){h(c);a()}):(ProcessConsole.clearConsole(),a())}function h(a){var c=FileEditor.loadEditor(),d=c.resource;if(null!=
d){var b=JSON.stringify({project:document.title,resource:d.filePath,source:c.source,directory:!1,create:!1});ProcessConsole.clearConsole();socket.send("SAVE:"+b);a&&FileEditor.updateEditor(c.source,d.projectPath)}}b.searchTypes=function(){DialogBuilder.createListDialog(function(a){a=l(a);for(var c=[],d=0;d<a.length;d++){var b=window.document.location.pathname,b=-1!==b.indexOf(";debug",b.length-6),e="/project/"+a[d].project;b&&(e+=";debug");e+="#"+a[d].resource;c.push([{text:a[d].name,link:e,style:"module"==
a[d].type?"moduleNode":"typeNode"},{text:a[d].resource,link:e,style:"resourceNode"}])}return c},null,"Search Types")};b.searchFiles=function(){DialogBuilder.createListDialog(function(a,c){for(var d=m(a,c),b=[],e=0;e<d.length;e++){var f=d[e],g=window.document.location.pathname;g.indexOf(";debug",g.length-6);g="/resource/"+f.project+"/"+f.resource;b.push([{text:f.resource,line:f.line,resource:g,style:"resourceNode"},{text:f.text,line:f.line,resource:g,style:"textNode"}])}return b},"*.snap,*.properties,*.xml,*.txt,*.json",
"Search Files")};b.findFileNames=function(){DialogBuilder.createListDialog(function(a){a=n(a);for(var c=[],d=0;d<a.length;d++){var b=a[d],e=window.document.location.pathname,e=-1!==e.indexOf(";debug",e.length-6),f="/project/"+b.project;e&&(f+=";debug");f+="#"+b.resource;c.push([{text:b.text,link:f,style:"resourceNode"}])}return c},null,"Find Files")};b.exploreDirectory=function(a){FileTree.isResourceFolder(a.filePath)&&(a=JSON.stringify({project:document.title,resource:a.filePath}),socket.send("EXPLORE:"+
a))};b.pingProcess=function(){isSocketOpen()&&socket.send("PING:"+document.title)};b.renameFile=function(a){var c=a.filePath;DialogBuilder.renameFileTreeDialog(a,!0,function(d){var b=JSON.stringify({project:document.title,from:c,to:d.filePath});socket.send("RENAME:"+b);renameEditorTab(a.resourcePath,d.resourcePath)})};b.renameDirectory=function(a){var c=a.filePath;a=FileTree.createResourcePath(c+".#");DialogBuilder.renameDirectoryTreeDialog(a,!0,function(a){a=JSON.stringify({project:document.title,
from:c,to:a.filePath});socket.send("RENAME:"+a)})};b.newFile=function(a){DialogBuilder.newFileTreeDialog(a,!0,function(a){if(!FileTree.isResourceFolder(a.filePath)){var c=JSON.stringify({project:document.title,resource:a.filePath,source:"",directory:!1,create:!0});ProcessConsole.clearConsole();socket.send("SAVE:"+c);FileEditor.updateEditor("",a.projectPath)}})};b.newDirectory=function(a){DialogBuilder.newDirectoryTreeDialog(a,!0,function(a){FileTree.isResourceFolder(a.filePath)&&(a=JSON.stringify({project:document.title,
resource:a.filePath,source:"",directory:!0,create:!0}),ProcessConsole.clearConsole(),socket.send("SAVE:"+a))})};b.saveFile=function(){k(function(){},!0)};b.saveEditor=h;b.deleteFile=function(a){var c=FileEditor.loadEditor();null==a&&null!=c.resource&&(a=c.resource);null!=a&&(c=FileEditor.loadEditor(),Alerts.createConfirmAlert("Delete File","Delete resource "+c.resource.filePath,"Delete","Cancel",function(){var b=JSON.stringify({project:document.title,resource:a.filePath});ProcessConsole.clearConsole();
socket.send("DELETE:"+b);null!=c.resource&&c.resource.resourcePath==a.resourcePath&&FileEditor.resetEditor();deleteEditorTab(a.resourcePath)},function(){}))};b.deleteDirectory=function(a){null!=a&&(a=JSON.stringify({project:document.title,resource:a.filePath}),ProcessConsole.clearConsole(),socket.send("DELETE:"+a))};b.runScript=function(){k(function(){var a=FileEditor.loadEditor(),a=JSON.stringify({breakpoints:a.breakpoints,project:document.title,resource:a.resource.filePath,source:a.source});socket.send("EXECUTE:"+
a)},!0)};b.updateScriptBreakpoints=function(){var a=FileEditor.loadEditor(),a=JSON.stringify({breakpoints:a.breakpoints,project:document.title});socket.send("BREAKPOINTS:"+a)};b.stepOverScript=function(){var a=ThreadManager.focusedThread();null!=a&&(a=JSON.stringify({thread:a.thread,type:"STEP_OVER"}),FileEditor.clearEditorHighlights(),socket.send("STEP:"+a))};b.stepInScript=function(){var a=ThreadManager.focusedThread();null!=a&&(a=JSON.stringify({thread:a.thread,type:"STEP_IN"}),FileEditor.clearEditorHighlights(),
socket.send("STEP:"+a))};b.stepOutScript=function(){var a=ThreadManager.focusedThread();null!=a&&(a=JSON.stringify({thread:a.thread,type:"STEP_OUT"}),FileEditor.clearEditorHighlights(),socket.send("STEP:"+a))};b.resumeScript=function(){var a=ThreadManager.focusedThread();null!=a&&(a=JSON.stringify({thread:a.thread,type:"RUN"}),FileEditor.clearEditorHighlights(),socket.send("STEP:"+a))};b.stopScript=function(){socket.send("STOP")};b.browseScriptVariables=function(a){var c=ThreadManager.focusedThread();
null!=c&&(a=JSON.stringify({thread:c.thread,expand:a}),socket.send("BROWSE:"+a))};b.browseScriptEvaluation=function(a,c,b){var d=ThreadManager.focusedThread();null!=d&&(a=JSON.stringify({thread:d.thread,expression:c,expand:a,refresh:b}),socket.send("EVALUATE:"+a))};b.attachProcess=function(a){var b=DebugManager.currentStatusFocus(),d=FileEditor.loadEditor();a=JSON.stringify({process:a,breakpoints:d.breakpoints,project:document.title,focus:b!=a});socket.send("ATTACH:"+a)};b.switchLayout=function(){var a=
window.document.location.pathname,b=window.document.location.hash;-1!==a.indexOf(";debug",a.length-6)?(a=a.substring(0,a.length-6),document.location=a+b):document.location=a+";debug"+b};b.evaluateExpression=function(){if(null!=ThreadManager.focusedThread()){var a=FileEditor.getSelectedText();DialogBuilder.evaluateExpressionDialog(a)}};b.switchProject=function(){document.location="/"}})(Command||(Command={}));
ModuleSystem.registerModule("commands","Commands module: commands.js",null,["common","editor","tree","threads"]);
