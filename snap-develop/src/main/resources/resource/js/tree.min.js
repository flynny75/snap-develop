var FileTree;
(function(f){function l(a,c,b,m,k,h,n,d){$(document).ready(function(){var g="/tree"+a+"?id\x3d"+b+"\x26folders\x3d"+k+"\x26depth\x3d"+d;null!=m&&(g+="\x26expand\x3d"+m);jQuery.ajax({url:g,success:function(a){$("#"+c).html(a);r(b,!k,h,n)},async:!0})})}function r(a,c,b,d){var k={autoExpandMS:400,focusOnClick:!0,preventVoidMoves:!0,preventRecursiveMoves:!0,dragStart:function(a,b){return!0},dragEnter:function(a,b){return!0},dragDrop:function(a,b){b.otherNode.moveTo(a,b.hitMode)}};$("#"+a).fancytree({extensions:c?["dnd"]:
[],click:d,expand:function(a,b){"undefined"!==typeof Command&&Command.folderExpand(b.node.key)},collapse:function(a,b){"undefined"!==typeof Command&&Command.folderCollapse(b.node.key)},dnd:c?k:null});null!=b&&$("#"+a).contextmenu({delegate:"span.fancytree-title",menu:[{title:"\x26nbsp;New",uiIcon:"menu-new",children:[{title:"\x26nbsp;File",cmd:"newFile",uiIcon:"menu-new"},{title:"\x26nbsp;Directory",cmd:"newDirectory",uiIcon:"menu-new"}]},{title:"\x26nbsp;Save",cmd:"saveFile",uiIcon:"menu-save"},
{title:"\x26nbsp;Rename",cmd:"renameFile",uiIcon:"menu-rename"},{title:"\x26nbsp;Delete",cmd:"deleteFile",uiIcon:"menu-trash",disabled:!1},{title:"\x26nbsp;Run",cmd:"runScript",uiIcon:"menu-run"},{title:"\x26nbsp;Explore",cmd:"exploreDirectory",uiIcon:"menu-explore"}],beforeOpen:function(a,b){$.ui.fancytree.getNode(b.target).setActive();b.menu.zIndex($(a.target).zIndex()+2E3)},select:function(a,c){var d=$.ui.fancytree.getNode(c.target),g=p(d.tooltip);b(g,c.cmd,c.key,d.isFolder())}})}function q(a){if(!stringEndsWith(a,
"/")){var c=a.split(".");return 1===a.length||""===c[0]&&2===c.length?!0:0<=c.pop().indexOf("/")}return!0}function d(a){if(null!=a){for(a=a.replace(/\/+/,"/").replace(/\.#/,"");-1!=a.indexOf("//");)a=a.replace("//","/");stringEndsWith(a,"/")&&(a=a.substring(0,a.length-1));return a}return null}function p(a){for(var c="/resource/"+document.title+"/",b="/resource/"+document.title;-1!=a.indexOf("//");)a=a.replace("//","/");if(a==b||a==c)return a={resourcePath:c,projectPath:"/",projectDirectory:"/",filePath:"/",
fileName:null,fileDirectory:"/",originalPath:a},JSON.stringify(a),a;0==!a.indexOf("/")&&(a="/"+a);0==!a.indexOf(c)&&(a="/resource/"+document.title+a);for(var c=q(a),b=a.split("/"),m="/resource/"+document.title,k="",h="",f=null,l="",g="",e=3;e<b.length;e++)m+="/"+b[e],k+="/"+b[e],l+="/"+b[e];if(c)if(3<b.length)for(e=3;e<b.length;e++)h+="/"+b[e],g+="/"+b[e];else g="/";else if(f=b[b.length-1],4<b.length)for(e=3;e<b.length-1;e++)h+="/"+b[e],g+="/"+b[e];else g="/";a={resourcePath:d(m),projectPath:d(k),
projectDirectory:d(""==h?"/":h),filePath:d(l),fileName:d(f),fileDirectory:d(g),originalPath:a};JSON.stringify(a);return a}f.createTree=function(a,c,b,d,f,h,n){l(a,c,b,d,f,h,n,1E4)};f.createTreeOfDepth=l;f.showTreeNode=function(a,c){a&&c&&c.resourcePath&&$("#"+a).fancytree("getTree").getNodeByKey(c.resourcePath).setActive()};f.isResourceFolder=q;f.cleanResourcePath=d;f.createResourcePath=p})(FileTree||(FileTree={}));ModuleSystem.registerModule("tree","Tree module: tree.js",null,null,["common"]);
