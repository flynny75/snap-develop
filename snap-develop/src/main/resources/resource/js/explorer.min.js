var FileExplorer;
(function(g){function h(a,b,c){FileTree.createTree("/"+document.title,"explorer","explorerTree","/.",!1,l,function(a,b){b.node.isFolder()||d(b.node.tooltip,function(){})})}function d(a,b){var c=a.toLowerCase();c.endsWith(".json")||c.endsWith(".js")?$.get(a,function(c){f(a,b,c)},"text").fail(function(){f(a,b,"// Could not find "+c)}):$.get(a,function(c){f(a,b,c)}).fail(function(){f(a,b,"// Could not find "+c)})}function f(a,b,c){if(null==FileEditor.resolveEditorMode(a)){var e=new Blob([c],{type:"application/octet-stream"}),
d=a.replace(/.*\//,"");saveAs(e,d)}else FileEditor.isEditorChanged()?(e="Save resource "+FileEditor.loadEditor().resource.filePath,Alerts.createConfirmAlert("File Changed",e,"Save","Ignore",function(){Command.saveEditor(!0)},function(){FileEditor.updateEditor(c,a)})):FileEditor.updateEditor(c,a);b()}function l(a,b,c,e){"runScript"==b?d(a.resourcePath,function(){Command.runScript()}):"newFile"==b?Command.newFile(a):"newDirectory"==b?Command.newDirectory(a):"exploreDirectory"==b?Command.exploreDirectory(a):
"renameFile"==b?e?Command.renameDirectory(a):Command.renameFile(a):"saveFile"==b?d(a.resourcePath,function(){Command.saveFile()}):"deleteFile"==b&&(FileTree.isResourceFolder(a.resourcePath)?Command.deleteDirectory(a):Command.deleteFile(a))}var k=!1;g.showTree=function(){0==k&&(window.setTimeout(h,500),k=!0);createRoute("RELOAD_TREE",h)};g.openTreeFile=d})(FileExplorer||(FileExplorer={}));
ModuleSystem.registerModule("explorer","Explorer module: explorer.js",FileExplorer.showTree,["common","spinner","tree","commands"]);
