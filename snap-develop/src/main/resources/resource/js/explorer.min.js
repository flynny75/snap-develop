var FileExplorer;
(function(g){function h(a,b,c){FileTree.createTree("/"+document.title,"explorer","explorerTree","/.",!1,l,function(a,b){b.node.isFolder()||f(b.node.tooltip,function(){})})}function f(a,b){var c=a.toLowerCase();stringEndsWith(c,".json")||stringEndsWith(c,".js")?$.get(a,function(c){d(a,b,c)},"text").fail(function(){d(a,b,"// Could not find "+c)}):$.get(a,function(c){d(a,b,c)}).fail(function(){d(a,b,"// Could not find "+c)})}function d(a,b,c){if(null==FileEditor.resolveEditorMode(a)){var e=new Blob([c],
{type:"application/octet-stream"}),d=a.replace(/.*\//,"");saveAs(e,d)}else FileEditor.isEditorChanged()?(e="Save resource "+FileEditor.loadEditor().resource.filePath,Alerts.createConfirmAlert("File Changed",e,"Save","Ignore",function(){Command.saveEditor(!0)},function(){FileEditor.updateEditor(c,a)})):FileEditor.updateEditor(c,a);b()}function l(a,b,c,d){"runScript"==b?f(a.resourcePath,function(){Command.runScript()}):"newFile"==b?Command.newFile(a):"newDirectory"==b?Command.newDirectory(a):"exploreDirectory"==
b?Command.exploreDirectory(a):"renameFile"==b?d?Command.renameDirectory(a):Command.renameFile(a):"saveFile"==b?f(a.resourcePath,function(){Command.saveFile()}):"deleteFile"==b&&(FileTree.isResourceFolder(a.resourcePath)?Command.deleteDirectory(a):Command.deleteFile(a))}var k=!1;g.showTree=function(){0==k&&(window.setTimeout(h,500),k=!0);EventBus.createRoute("RELOAD_TREE",h)};g.openTreeFile=f;g.openTreeHistoryFile=function(a,b,c){var e=a.toLowerCase(),f=a.replace(/^\/resource/i,"/history");stringEndsWith(e,
".json")||stringEndsWith(e,".js"),jQuery.ajax({url:f+"?time\x3d"+b,type:"get",success:function(b){d(a,c,b)},error:function(b){d(a,c,"// Could not find "+e)},async:!1})}})(FileExplorer||(FileExplorer={}));ModuleSystem.registerModule("explorer","Explorer module: explorer.js",null,FileExplorer.showTree,["common","spinner","tree","commands"]);
