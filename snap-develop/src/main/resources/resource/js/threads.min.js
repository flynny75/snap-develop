var ThreadManager;
(function(d){function r(a,b,c){a=JSON.parse(c);e={};h();clearVariables();Profiler.clearProfiler();k();StatusPanel.showProcessStatus(a.resource,a.process)}function m(a,b,e){null!=c&&c.process==e&&n()}function n(){e={};h();FileEditor.clearEditorHighlights();clearVariables();k()}function k(){h();w2ui.threads.records=[];w2ui.threads.refresh();$("#process").html("")}function t(a,b,d){a=JSON.parse(d);FileEditor.loadEditor();b=a.thread==a.thread?"SUSPENDED"!=a.status:!1;if(b)h(),l(a),FileEditor.clearEditorHighlights();else if(c.thread==
a.thread){a:{if(c.thread==a.thread&&"SUSPENDED"==a.status){if(c.key!=a.key){b=!0;break a}if(c.change!=a.change){b=!0;break a}}b=!1}b&&(u(a),l(a))}else null==c.thread?(v(a),l(a)):(b=e[a.thread],(null!=b&&null!=a?b.thread!=a.thread||b.status!=a.status||b.resource!=a.resource||b.line!=a.line:b!=a)&&l(a));e[a.thread]=a;p(a)}function p(a){var b=FileEditor.loadEditor();c.thread==a.thread&&b.resource.filePath==a.resource&&"SUSPENDED"==a.status&&FileEditor.createEditorHighlight(a.line,"threadHighlight")}
function l(a){e[a.thread]=a;q();showVariables()}function u(a){if(c.thread==a.thread&&c.line!=a.line)if(w(a)){var b=FileTree.createResourcePath(a.resource);FileExplorer.openTreeFile(b.resourcePath,function(){f(a);FileEditor.showEditorLine(a.line)})}else f(a),FileEditor.showEditorLine(a.line);else f(a)}function v(a){if(FileEditor.loadEditor().resource.filePath!=a.resource){var b=FileTree.createResourcePath(a.resource);FileExplorer.openTreeFile(b.resourcePath,function(){f(a);FileEditor.showEditorLine(a.line)})}else f(a),
FileEditor.showEditorLine(a.line)}function w(a){return c.thread==a.thread?FileEditor.loadEditor().resource.filePath!=a.resource:!1}function h(){clearVariables();c={thread:null,process:null,resource:null,change:-1,line:-1,key:-1}}function f(a){c={thread:a.thread,process:a.process,resource:a.resource,line:a.line,change:a.change,key:a.key}}function q(){FileEditor.loadEditor();var a=[],b=1,d;for(d in e)if(e.hasOwnProperty(d)){var g=e[d],f="threadSuspended",h="\x26nbsp;\x3cinput type\x3d'radio'\x3e";p(g);
"SUSPENDED"!=g.status?f="threadRunning":c.thread==g.thread&&(h="\x26nbsp;\x3cinput type\x3d'radio' checked\x3e");var f="\x3cdiv title\x3d'"+g.stack+"' class\x3d'"+f+"'\x3e"+d+"\x3c/div\x3e",k=FileTree.createResourcePath(g.resource);a.push({recid:b++,name:f,thread:d,status:g.status,active:h,instruction:g.instruction,variables:g.variables,resource:g.resource,key:g.key,line:g.line,script:k.resourcePath})}updateTableRecords(a,"threads")}var e={},c={};d.createThreads=function(){createRoute("BEGIN",r,k);
createRoute("SCOPE",t,clearVariables);createRoute("TERMINATE",m);createRoute("EXIT",m)};d.terminateThreads=n;d.clearThreads=k;d.focusedThread=function(){return null!=c.thread?e[c.thread]:null};d.updateThreadFocusByName=function(a){f(e[a])};d.focusedThreadVariables=function(){if(null!=c.thread){var a=e[c.thread];if(null!=a)return a.variables}return{}};d.focusedThreadEvaluation=function(){if(null!=c.thread){var a=e[c.thread];if(null!=a)return a.evaluation}return{}};d.showThreads=q})(ThreadManager||
(ThreadManager={}));ModuleSystem.registerModule("threads","Thread module: threads.js",ThreadManager.createThreads,["common","socket","explorer"]);
